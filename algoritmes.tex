\documentclass[main.tex]{subfiles}
\begin{document}

\chapter{Algoritmes}
\label{cha:algoritmes}

\section{Integreren over twee veranderlijke met een onderling afhankelijk domein}
\subsection*{Abstract}
\subsubsection*{Vraag}
Gegeven een functie $f$ in twee veranderlijken:
\[ f:\ A \subseteq \mathbb{R}^{2} \rightarrow \mathbb{R}:\ (x,y) \mapsto f(x,y) \]
Zij $P$ het predicaat dat bepaalt of een koppel $(x,y)\in\mathbb{R}^{2}$ tot $A$ behoort.
\[ \forall (x,y) \in \mathbb{R}^{2}:\ (x,y)\in A \Leftrightarrow P(x,y) \]
$A$ is dan gedefinieerd als volgt:
\[ A = \{ (x,y) \mid P(x,y) \} \]
Bereken de volgende integraal:
\[ \int_{(x,y)\in A}f(x,y)\ dx dy \]

\subsubsection*{Antwoord}
We zullen proberen de integraal op te splitsen in twee integralen.
We hebben daarvoor een aangepaste versie van het predicaat $P$ nodig, namelijk het predicaat $P_{x}$ of $P_{y}$.
$P_{y}(x)$ is het predicaat dat voor een gegeven $y$ bepaalt of een $x$ tot $A$ behoort:
\[ \forall (x,y) \in \mathbb{R}^{2}:\ (x,y)\in A \Leftrightarrow P_{y}(x) \]
Aan de hand van $P_{y}(x)$ of $P_{x}(y)$ kunnen we respectievelijk $A_{y}$ en $A_{x}$ definieren:
\[ A_{y} = \{ (x,y) \mid P_{y}(x) \} \]
Eveneens defini\"eren we $E_{X}$ en $E_{Y}$ als volgt:
\[ E_{X} = \{ x \in\mathbb{R} \mid \exists y \in \mathbb{R}:\ P_{y}(x) \} \]
We kunnen nu de integraal splitsen:
\[ \int_{(x,y)\in A}f(x,y)\ dx = \int_{x\in E_{X}}\int_{y\in A_{x}}f(x,y)\ dy\ dx \]
Op dit punt kunnen we de integraal eenvoudig uitrekenen als twee enkelvoudige integralen.

\subsection*{Voorbeeld}
\subsubsection*{Vraag}
Zij $f$ gedefinieerd op $A = \{ (x,y)\in \interval{0}{1}^{2} \mid x^{2} \le y \}$ als volgt:
\[ f:\ A \rightarrow \mathbb{R}:\ (x,y) \mapsto 3x^{2} + xy + 2y^{2} \]
Bereken de integraal van $f$ over heel $A$.

\subsubsection*{Antwoord}
We bepalen eerst $A_{x}$:
\[ A_{x} = \{ (x,y) \in \interval{0}{1}^{2} \mid y \ge x^{2} \} \]

\begin{figure}[H]
  \centering
  \begin{tikzpicture}[scale=4]
    \draw[->] (0,0) -- (1.1,0) node[right] {$x$};
    \draw[->] (0,0) -- (0,1.1) node[above] {$y$};
    \draw (1,0) -- (1,1) node {};
    \draw (0,1) -- (1,1) node {};
    \filldraw[thick,fill=green!80!black,opacity=.4] plot [smooth,domain=0:1] ({\x},{\x^2}) -- (0,1) -- cycle;
  \end{tikzpicture}
  \caption{$A$}
\end{figure}
\noindent
We kunnen nu de integraal spliten:
\[ \int_{0}^{1} \int_{x^{2}}^{1}f(x,y)\ dy\ dx \]
... en uitrekenen.
\begin{align*}
  \int_{0}^{1} \int_{x^{2}}^{1}3x^{2} + xy + 2y^{2}\ dy\ dx
  &= \int_{0}^{1} \left( 3x^{2}(1-x^{2}) + \frac{x}{2}(1-x^{4}) + (1-x^{6})\right)\ dx\\
  &= \int_{0}^{1}-x^{6}-\frac{1}{2}x^{5}-3x^{4}+3x^{2}+\frac{1}{2}x 1\ dx\\
  &= -\frac{1}{7} - \frac{1}{12} - \frac{3}{5} + 1 + \frac{1}{4} + 1\\
  &=  \frac{299}{210}
\end{align*}


\newpage
\section{Opzoeken in de tabel van de standaard normale verdeling}
Het is niet evident en niet uitgelegd hoe iets in de tabel van de standaard normale verdeling opgezocht kan worden. 
Hier daarom wat uitleg.

Allereerst is het belangrijk om te weten dat de getallen in de tabel zelf de kans $P(Z \le z)$ voorstel, waarbij $z$ wordt gegeven door de rand van de tabel.
De som van de waarde aan het begin van de rij en de waarde het begin van de kolom geeft u de $z$ waarvoor $P(Z \le z)$ in de tabel staat.

In de tabel staat natuurlijk niet de kans $P(Z \le z)$ voor alle mogelijke $z$.
Er staan alleen kansen in voor bepaalde $z \in \interval{0}{3.3}$ en enkel voor maximum twee cijfers na de komma.
De maker van de tabel ging er bovendien van uit dat u twee dingen weet:

\[ P(Z \le z) = 1 - P(Z > z) \quad\text{ en }\quad P(Z \le z) = P(Z \ge -z) \]

Merk op dat die eerste gelijkheid strikt klopt, maar omdat we de resultaten toch al niet exact zijn (door afrondingen) maken we er eveneens het volgende van:
\footnote{Ja. Ik weet het. Ik vind het ook lelijk maar dat is nu eenmaal waar statistici zich mee bezig houden.}
\[ P(Z \le z) = 1 - P(Z \le z) \]
Aan de hand van deze twee regels kunnen we uit de tabel nog veel meer informatie halen.

We kunnen bovendien, mits een beetje gefoefel, de tabel ook gebruiken om, gegeven een bepaalde kans $P(Z \le z)$ de $z$ te bepalen. 

\subsection*{Abstract}
\subsubsection*{Vraag}
\begin{itemize}
\item 
  \begin{enumerate}
  \item Bepaal $P(Z \le z)$ voor $z \in\interval{0}{3.3}$
  \item Bepaal $P(Z \ge z)$ voor $z \in\interval{0}{3.3}$
  \item Bepaal $P(Z \le z)$ voor $z \in\interval{-3.3}{0}$
  \item Bepaal $P(Z \ge z)$ voor $z \in\interval{-3.3}{0}$
  \end{enumerate}
\item
  \begin{itemize}
  \item Bepaal $z$ zodat $P(Z \le z) = p$ geldt met $p \in \interval{0.5}{1}$ 
  \item Bepaal $z$ zodat $P(Z \ge z) = p$ geldt met $p \in \interval{0.5}{1}$
  \item Bepaal $z$ zodat $P(Z \le z) = p$ geldt met $p \in \interval{0}{0.5}$
  \item Bepaal $z$ zodat $P(Z \ge z) = p$ geldt met $p \in \interval{0}{0.5}$
  \end{itemize}
\end{itemize}

\subsubsection*{Antwoord}
\begin{itemize}
\item 
  \begin{enumerate}
  \item Lees $P(Z \le z)$ af.
  \item Lees $P(Z \le z)$ af. Het resultaat is $1-P(Z \le z)$.
  \item Lees $P(Z \le -z)$ af. Het resultaat is $1-P(Z \le -z)$.
  \item Lees $P(Z \le -z)$ af. Dit is meteen het resultaat.
  \end{enumerate}
\item
  \begin{enumerate}
  \item Zoek $p$ in de tabel en tel de hoofdingen op.
  \item Zoek $p$ in de tabel en tel de hoofdingen op om $-z$ te bekomen.
  \item Zoek $1-p$ in de tabel en tel de hoofdingen op om $-z$ te bekomen.
  \item Zoek $1-p$ in de tabel en tel de hoofdingen op om $z$ te bekomen.
  \end{enumerate}
\end{itemize}


\subsection*{Voorbeeld}
\subsubsection*{Vraag}
\begin{itemize}
\item
  \begin{enumerate}
  \item Bepaal $P(Z \le 1.25)$
  \item Bepaal $P(Z \ge 1.25)$
  \item Bepaal $P(Z \le -0.3)$
  \item Bepaal $P(Z \ge -0.3)$
  \end{enumerate}
\item
  \begin{enumerate}
  \item Bepaal $z$ zodat $P(Z \le z) = 0.6$ geldt
  \item Bepaal $z$ zodat $P(Z \ge z) = 0.6$ geldt
  \item Bepaal $z$ zodat $P(Z \le z) = 0.2$ geldt
  \item Bepaal $z$ zodat $P(Z \ge z) = 0.2$ geldt.
  \end{enumerate}
\end{itemize}
\subsubsection*{Antwoord}
\begin{itemize}
\item
  \begin{enumerate}
  \item $P(Z \le 1.25) = 0.894$
  \item $P(Z \ge 1.25) = 1-P(Z \le 1.25) = 1- 0.894 = 0.106$
  \item $P(Z \le -0.3) = P(Z \ge 0.3) = 1- P(Z \le 0.3) = 1-0.619 = 0.381$
  \item $P(Z \ge -0.3) = P(Z \le 0.3) = 0.619$
  \end{enumerate}
\item
  \begin{enumerate}
  \item $P(Z \le z) = 0.6 \Rightarrow z = 0.25$
  \item $P(Z \ge z) = 0.6 \Rightarrow P(Z \le -z) = 0.6 \Rightarrow -z = 0.25 \Rightarrow z = -0.25$ 
  \item $P(Z \le z) = 0.2 \Rightarrow 1-P(Z \ge z) = 0.2 \Rightarrow P(Z \ge z) = 0.8 \Rightarrow P(Z \le -z) = 0.8 \Rightarrow -z = 0.84 \Rightarrow z = -0.84$
  \item $P(Z \ge z) = 0.2 \Rightarrow 1-P(Z \le z) = 0.2 \Rightarrow P(Z \le z) = 0.8 \Rightarrow z = 0.8$
  \end{enumerate}
\end{itemize}


\newpage
\section{Het systeembetrouwbaarheid stramien}
\subsection*{Abstract}
\subsubsection*{Vraag}
Gegeven een systeem dat bestaat uit \textbf{onafhankelijke componenten} en gegeven de faalkansen van alle componenten behalve \'e\'en alsook de kans dat de laatste component heeft gefaald, gegeven dat het hele systeem faalt.
Bereken de laatste faalkans.

Dit soort oefeningen kan nog veel uitgebreider zijn.
Hier is daarom een stappenplan voor het oplossen van dit soort oefeningen.

\subsubsection*{Antwoord}
\begin{enumerate}
\item Bereken (parametrisch) de faalkans van heel het systeem aan de hand van de rekenregels voor faalkansen in een systeem.
  Dit doen we door het systeem stukje bij beetje te vereenvoudigen door componenten te combineren tot \'e\'en groter geheel.
  \begin{itemize}
  \item Twee componenten $A$ en $B$ die in serie staan vervangen we door een component $C$ met faalkans $p_{C} = p_{a} + p_{b} - p_{a}p_{b}$. Er moet immers maar \'e\'en van de twee componenten $A$ en $B$ falen om $C$ te doen falen.
  \item Twee componenten $A$ en $B$ die in parallel staan vervangen we door een component $C$ met faalkans $p_{C} = p_{a}p_{b}$. $A$ en $B$ moeten immers beide falen om $C$ te doen falen.
  \end{itemize}
  Dit tot we met \'e\'en enkele component overblijven.
  De faalkans van deze component is dan de faalkans van heel het systeem.
\item Herschrijf de kans dat de laatste component heeft gefaald, gegeven dat het hele systeem faalt (waarschijnlijk) aan de hand van de regel van Bayes.
  In die herschrijving zal het gevraagde al staan, maar ook nog onbekenden.
We kunnen nu redeneren over de onbekenden om te bepalen wat die zullen zijn, of we kunnen gewoon de faalkans $p_{S}$ gebruiken die we eerder al berekend hebben.
\item We rekenen nu verder uit om de gevraagde kans te bekomen. Er zullen meerdere mogelijkheden zijn om hetzelfde te bekomen.
Maak het jezelf niet moeilijk en kies de makkelijkste.
\end{enumerate}

\subsection*{Voorbeeld}
\subsubsection*{Vraag}
Gegeven een systeem $S$ dat bestaat uit onafhankelijke componenten $A$, $B$, $C$, $D$ en $E$.
$A$ en $B$, en $D$ en $E$ staan in serie. Deze twee combinaties staan, samen met $C$ in parallel.
De faalkansen van $A$, $B$, $C$ en $D$ zijn gegeven:
\[ p_{A} = 0.01,\quad p_{B} = 0.02,\quad p_{C} = 0.04,\quad p_{D} = 0.08 \]
Wat is de faalkans van $E$ als we weten dat de kans dat $E$ gefaald heeft, gegeven dat het hele systeem faalt $0.1$ is.

\subsubsection*{Antwoord}
\begin{enumerate}
\item Eerst berekenen we de faalkans van heel het systeem:
  \begin{itemize}
  \item Vervang $A$ en $B$ door $F$ met $p_{f} = p_{A} + p_{B} - p_{A}p_{B}$
  \item Vervang $D$ en $E$ door $G$ met $p_{G} = p_{D} + p_{E} - P_{D}p_{E}$
  \item Vervang $F$, $G$ en $C$ door $H$ met $p_{H} = p_{C}p_{F}p_{G} = p_{C}(p_{A} + p_{B} - p_{A}p_{B})(p_{D} + p_{E} - P_{D}p_{E})$
  \end{itemize}
  De faalkans van heel het systeem is dus $p_{S}$ als volgt:
  \[ p_{S} = p_{C}(p_{A} + p_{B} - p_{A}p_{B})(p_{D} + p_{E} - P_{D}p_{E})\]
\item We herschrijven $P(E|S)$:
  \[ P(E | S) = \frac{P(S | E)P(E)}{P(S)} = \frac{P(S|E)P(E)}{P(S|E)P(E) + P(S|E^{C})P(E^{C})} \]
  \begin{itemize}
  \item $P(S|E)$ vinden we door te redeneren:
    Als $E$ gefaald heeft, hoe kan het systeem dan nog falen?
    Als $E$ gefaald heeft, valt allesinds al de tak van $D$ en $E$ als weg.
    De faalkans van het overblijvende systeem geeft ons dat $P(S|E)$.
    In dit geval is dat $p_{C}(p_{A}+p_{B}-p_{A}p_{B})$.
  \item $P(S|E^{C})$ vinden we opnieuw door te redeneren:
    Als $E$ zeker niet gefaald heeft, hoe kan het systeem dan nog falen?
    We kunnen ons dit inbeelden alsof we $E$ weglaten uit het systeem.
    De faalkans van het overblijvende systeem, en dus dus de kans $P(S|E^{C})$ is dan $p_{C}(p_{A} + p_{B} - p_{A}p_{B})p_{D}$.
  \item We kunnen natuurlijk ook gewoon $P(S)=p_{s}$ zoals we dat hierboven uitgerekend hebben, gebruiken.
  \end{itemize}
\item We gebruiken nu de gemakkelijkste van volgende vergelijkingen om $p_{E}$ te bepalen. Natuurlijk komen ze op hetzelfde neer. 
  \begin{itemize}
  \item
    \begin{align*}
      P(E | S) = \frac{P(S | E)P(E)}{P(S)}
      &= \frac{p_{C}(p_{A}+p_{B}-p_{A}p_{B})p_{E}}{p_{C}(p_{A} + p_{B} - p_{A}p_{B})(p_{D} + p_{E} - P_{D}p_{E})}\\
      0.1&=\frac{0.04(0.01+0.02-(0.01)(0.02))p_{E}}{0.04(0.01+0.02-(0.01)(0.02))(0.08 + p_{E} - 0.08p_{E}} \\
      0.1&=\frac{0.001192p_{E}}{0.00192(0.08 + p_{E} - 0.08p_{E})}
      p_{E}&= 0.0088106
    \end{align*}
  \item
    \[
      P(E | S)
      = \frac{P(S|E)P(E)}{P(S|E)P(E) + P(S|E^{C})P(E^{C})}
      =\frac{p_{C}(p_{A}+p_{B}-p_{A}p_{B})p_{E}}{p_{C}(p_{A}+p_{B}-p_{A}p_{B})p_{E} + p_{C}(p_{A} + p_{B} - p_{A}p_{B})p_{D}(1-p_{E})}
    \]
    \begin{align*}
      0.1 &= \frac{0.04(0.01+0.02-(0.01)(0.02))p_{E}}{0.04(0.01+0.02-(0.01)(0.02))p_{E} + (0.04(0.01+0.02-(0.01)(0.02))0.08)(1-p_{E})}\\
    \end{align*}
    Dat laatste is duidelijk meer werk.
  \end{itemize}
\end{enumerate}


\newpage
\section{Verwachtingswaarde en variantie berekenen aan de hand van een MGF}
\subsection*{Abstract}
\subsubsection*{Vraag}
Gegeven de momentgenererende functie $M_{X}(t)$ van een stochastische variabele $X$, bepaal de verwachtingswaarde en de variantie van $X$.

\subsubsection*{Antwoord}
De verwachtingswaarde is gelijk aan het eerste ruwe moment.
\[ E[X] = \alpha_{1} \]
De variantie is gelijk aan het eerste centrale moment, dat we overigens kunnen schrijven in functie van het eerste ruwe en het tweede ruwe moment:
\[ Var[X] = \mu_{1}(X) = \alpha_{2}(X) - \alpha_{1}(X)^{2} = E[X^{2}] - E[X]^{2} \]
De ruwe momenten kunnen we tenslotte vinden door de momentgenererende functie af te lijden en daarna te evalueren in nul.
\[ \alpha_{k} = \left.\frac{d^{k}}{dt^{k}}M_{X}(t)\right|_{t=0} \]

\subsection*{Voorbeeld}
\subsubsection*{Vraag}
Zij $X$ een stochastische variabele met de volgende momentgenererende functie:
\[ M_{X}(t) = e^{-5t} \]
Bepaal de verwachtingswaarde en de variantie van $X$.

\subsubsection*{Antwoord}
We berekenen eerst de afgeleide van $M_{X}(t)$:
\[ \frac{d}{dt}M_{X}(t) = -5e^{-5t} \]
In $t=0$ is dit $-5$.
De verwachtinsgwaarde van $X$ is dus $-5$.\\
Nu de tweede afgeleide van $M_{X}(t)$:
\[ \frac{d^{2}}{dt^{2}}M_{X}(t) = \frac{d}{dt} -5e^{-5t} = 25e^{-5t} \]
In $t=0$ is dit $25$.
De variantie van $X$ kunnen we nu eenvoudig berekenen:
\[ Var[X] = 25 - (-5)^{2} = 0 \]

\iffalse
\newpage
\section{algoritme}
\subsection*{Abstract}
\subsubsection*{Vraag}
\subsubsection*{Antwoord}
\subsection*{Voorbeeld}
\subsubsection*{Vraag}
\subsubsection*{Antwoord}
\fi

\end{document}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: t
%%% End:
